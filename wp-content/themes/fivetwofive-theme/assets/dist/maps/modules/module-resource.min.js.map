{"version":3,"sources":["modules/module-resource.js"],"names":["$","FTF","ScrollReveal","resourceModule","module","_classCallCheck","this","itemPerPage","dataset","paginationContainer","querySelector","animationConfig","mobile","duration","interval","reset","distance","_createClass","key","value","formInit","paginationInit","reveal","querySelectorAll","_this","addEventListener","event","preventDefault","fetchResources","page","_this2","requestURL","URL","restBase","searchParams","append","search","category","_this$module$querySel","_this$module$querySel2","isLoading","ajax","url","href","done","data","textStatus","request","updateResources","generatePagination","getResponseHeader","always","isComplete","_this3","resourcesWrap","innerHTML","forEach","resource","insertAdjacentHTML","createResource","animateResources","console","log","_resource$_embedded","_resource$_embedded$w","_resource$_embedded$w2","_resource$_embedded$w3","_resource$_embedded$w4","_resource$_embedded$w5","resourceHTML","concat","id","ftf_resource_categories","link","name","_embedded","media_details","sizes","source_url","title","rendered","date","ftf_formatted_date","totalPages","currentPage","paginationNav","setupPaginationNav","generatePaginationLinks","insertAdjacentElement","document","createElement","classList","add","setAttribute","paginationHeading","textContent","paginationLinks","current","arguments","length","undefined","Number","parseInt","index","_this4","currentTarget","generateSpinner","removeAttribute","init","jQuery","FiveTwoFive"],"mappings":"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","file":"../../js/modules/module-resource.min.js","sourcesContent":["( function( $, FTF, ScrollReveal ) {\n\t'use strict';\n\n\tclass resourceModule {\n\t\tconstructor( module ) {\n\t\t\tthis.module = module;\n\t\t\tthis.itemPerPage = module.dataset.itemPerPage;\n\t\t\tthis.paginationContainer = module.querySelector( '.ftf-module__pagination-container' );\n\t\t\tthis.animationConfig = {\n\t\t\t\tmobile: false,\n\t\t\t\tduration: 1000,\n\t\t\t\tinterval: 300,\n\t\t\t\treset: false,\n\t\t\t\tdistance: '10px',\n\t\t\t};\n\t\t}\n\n\t\tinit() {\n\t\t\tthis.formInit();\n\t\t\tthis.paginationInit();\n\t\t}\n\n\t\tanimateResources() {\n\t\t\tScrollReveal().reveal( this.module.querySelectorAll( '.card' ), this.animationConfig );\n\t\t}\n\n\t\tformInit() {\n\t\t\tthis.module.querySelector( '.ftf-form' ).addEventListener( 'submit', ( event ) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.fetchResources( 1 );\n\t\t\t} );\n\t\t}\n\n\t\tfetchResources( page ) {\n\t\t\tconst requestURL = new URL( FTF.restBase );\n\t\t\trequestURL.searchParams.append( '_fields', 'id,date_gmt,ftf_formatted_date,ftf_resource_categories,title,link,_links,_embedded' );\n\t\t\trequestURL.searchParams.append( 'per_page', this.itemPerPage );\n\t\t\trequestURL.searchParams.append( 'page', page );\n\t\t\trequestURL.searchParams.append( '_embed', 'wp:featuredmedia' );\n\n\t\t\tconst search = this.module.querySelector( '[name=\"ftf-search-resource\"]' ).value;\n\t\t\tconst category = this.module.querySelector( '[name=\"ftf-category-resource\"]' )?.value ?? null;\n\n\t\t\tif ( search ) {\n\t\t\t\trequestURL.searchParams.append( 'search', search );\n\t\t\t}\n\n\t\t\tif ( category && category !== '0' ) {\n\t\t\t\trequestURL.searchParams.append( 'ftf-resource-categories', category );\n\t\t\t}\n\n\t\t\tthis.isLoading();\n\n\t\t\t$.ajax( { url: requestURL.href } )\n\t\t\t\t.done( ( data, textStatus, request ) => {\n\t\t\t\t\tif ( 'success' === textStatus ) {\n\t\t\t\t\t\tthis.updateResources( data );\n\t\t\t\t\t\tthis.generatePagination( request.getResponseHeader( 'X-WP-TotalPages' ) );\n\t\t\t\t\t}\n\t\t\t\t} ).always( () => {\n\t\t\t\t\tthis.isComplete();\n\t\t\t\t} );\n\t\t}\n\n\t\tupdateResources( data ) {\n\t\t\tconst resourcesWrap = this.module.querySelector( '.ftf-resources-wrap' );\n\n\t\t\tresourcesWrap.innerHTML = '';\n\n\t\t\tdata.forEach( ( resource ) => {\n\t\t\t\tresourcesWrap.insertAdjacentHTML( 'beforeend', this.createResource( resource ) );\n\t\t\t} );\n\n\t\t\tthis.animateResources();\n\t\t}\n\n\t\tcreateResource( resource ) {\n\t\t\tconsole.log(resource);\n\t\t\tlet resourceHTML = '';\n\t\t\tif ( resource ) {\n\t\t\t\tresourceHTML = `\n          <div class=\"col-md-4 mb-3 mb-md-5\">\n            <article id=\"card-${ resource.id }\" class=\"card post-2990 ftf_resource type-ftf_resource status-publish has-post-thumbnail hentry load-hidden\">`;\n\n\t\t\t\tresourceHTML += '<div class=\"card__top\">';\n\n\t\t\t\tif ( resource?.ftf_resource_categories ) {\n\t\t\t\t\tresourceHTML += `<ul class=\"card__categories\">`;\n\n\t\t\t\t\tresource.ftf_resource_categories.forEach( ( category ) => {\n\t\t\t\t\t\tresourceHTML += `<li><a href=\"${ category.link }\">${ category.name }</a></li>`;\n\t\t\t\t\t} );\n\n\t\t\t\t\tresourceHTML += `</ul>`;\n\t\t\t\t}\n\n\t\t\t\tif ( resource._embedded?.[ 'wp:featuredmedia' ]?.[ 0 ]?.media_details?.sizes?.[ 'ftf-resource-thumb' ]?.source_url ) {\n\t\t\t\t\tresourceHTML += `<img width=\"415\" height=\"245\" src=\"${ resource._embedded[ 'wp:featuredmedia' ][ 0 ].media_details.sizes[ 'ftf-resource-thumb' ].source_url }\" class=\"card__image img-responsive wp-post-image\" alt=\"${ resource.title.rendered }\" loading=\"lazy\">`;\n\t\t\t\t}\n\n\t\t\t\tresourceHTML += '</div>';\n\n\t\t\t\tresourceHTML += `\n\t\t\t\t\t  <div class=\"card__bottom\">\n\t\t\t\t\t\t<header class=\"card__header m-0\">\n\t\t\t\t\t\t  <div class=\"ftf-post-meta entry-meta\"><span class=\"posted-on\"><a href=\"${ resource.link }\" rel=\"bookmark\"><time class=\"entry-date published\" datetime=\"${ resource.date }\">${ resource.ftf_formatted_date }</time></a></span></div>\n\t\t\t\t\t\t  <h3 class=\"card__title mt-2\"><a href=\"${ resource.link }\">${ resource.title.rendered }</a></h3>\n\t\t\t\t\t\t</header>\n\t\t\t\t\t  </div>\n\t\t\t\t\t</article>\n\t\t\t\t  </div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\treturn resourceHTML;\n\t\t}\n\n\t\tgeneratePagination( totalPages ) {\n\t\t\tthis.paginationContainer.innerHTML = '';\n\n\t\t\tif ( totalPages <= 1 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentPage = this.module.dataset.currentPage;\n\t\t\tconst paginationNav = this.setupPaginationNav();\n\t\t\tpaginationNav.querySelector( '.nav-links' ).innerHTML = this.generatePaginationLinks( currentPage, totalPages );\n\n\t\t\tthis.paginationContainer.insertAdjacentElement( 'beforeend', paginationNav );\n\n\t\t\tthis.paginationInit();\n\t\t}\n\n\t\tsetupPaginationNav() {\n\t\t\tconst paginationNav = document.createElement( 'nav' );\n\t\t\tpaginationNav.classList.add( 'navigation', 'pagination' );\n\t\t\tpaginationNav.setAttribute( 'role', 'navigation' );\n\t\t\tpaginationNav.setAttribute( 'aria-label', 'Resources' );\n\n\t\t\tconst paginationHeading = document.createElement( 'h2' );\n\t\t\tpaginationHeading.classList.add( 'screen-reader-text' );\n\t\t\tpaginationHeading.textContent = 'Resources navigation';\n\n\t\t\tconst paginationLinks = document.createElement( 'div' );\n\t\t\tpaginationLinks.classList.add( 'nav-links' );\n\n\t\t\tpaginationNav.insertAdjacentElement( 'afterbegin', paginationHeading );\n\t\t\tpaginationNav.insertAdjacentElement( 'beforeend', paginationLinks );\n\n\t\t\treturn paginationNav;\n\t\t}\n\n\t\tgeneratePaginationLinks( current = 1, totalPages ) {\n\t\t\tlet paginationLinks = '';\n\t\t\tcurrent = Number.parseInt( current, 10 );\n\n\t\t\tfor ( let index = 1; index <= totalPages; index++ ) {\n\t\t\t\tif ( index === current ) {\n\t\t\t\t\tpaginationLinks += `<span aria-current=\"page\" class=\"page-numbers current\">${ index }</span>`;\n\t\t\t\t} else {\n\t\t\t\t\tpaginationLinks += `<a class=\"page-numbers\" data-page=\"${ index }\" href=\"#\">${ index }</a>`;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn paginationLinks;\n\t\t}\n\n\t\tpaginationInit() {\n\t\t\tthis.module.querySelectorAll( '.page-numbers' ).forEach( ( link ) => {\n\t\t\t\tlink.addEventListener( 'click', ( event ) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconst currentPage = Number.parseInt( event.currentTarget.dataset.page, 10 );\n\t\t\t\t\tthis.module.dataset.currentPage = currentPage;\n\t\t\t\t\tthis.fetchResources( currentPage );\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\n\t\tgenerateSpinner() {\n\t\t\treturn `<div class=\"fivetwofive-spinner\"><div></div><div></div></div>`;\n\t\t}\n\n\t\tisLoading() {\n\t\t\tconst resourcesWrap = this.module.querySelector( '.ftf-resources-wrap' );\n\n\t\t\tthis.module.querySelector( 'input[type=\"submit\"]' ).setAttribute( 'disabled', 'disabled' );\n\t\t\tresourcesWrap.innerHTML = this.generateSpinner();\n\t\t}\n\n\t\tisComplete() {\n\t\t\tthis.module.querySelector( 'input[type=\"submit\"]' ).removeAttribute( 'disabled' );\n\t\t}\n\t}\n\n\t$( function() {\n\t\tconst modules = document.querySelectorAll( '.ftf-module-resources' );\n\n\t\tmodules.forEach( ( module ) => {\n\t\t\tconst singleResourceModule = new resourceModule( module );\n\t\t\tsingleResourceModule.init();\n\t\t} );\n\t} );\n}( jQuery, FiveTwoFive, ScrollReveal ) );\n"]}